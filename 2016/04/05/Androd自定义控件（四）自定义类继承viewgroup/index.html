<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  
  <title>Androd自定义控件（四）自定义类继承viewgroup | PleaseCallMeCoder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="自定义类继承ViewGroup。">
<meta property="og:type" content="article">
<meta property="og:title" content="Androd自定义控件（四）自定义类继承viewgroup">
<meta property="og:url" content="http://yoursite.com/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/index.html">
<meta property="og:site_name" content="PleaseCallMeCoder">
<meta property="og:description" content="自定义类继承ViewGroup。">
<meta property="og:image" content="http://img.blog.csdn.net/20160405181247461">
<meta property="og:updated_time" content="2016-05-06T14:28:07.383Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Androd自定义控件（四）自定义类继承viewgroup">
<meta name="twitter:description" content="自定义类继承ViewGroup。">
<meta name="twitter:image" content="http://img.blog.csdn.net/20160405181247461">
  
    <link rel="alternative" href="/atom.xml" title="PleaseCallMeCoder" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
      <link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet">
  
  
  
      <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
      <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">
  
  <link rel="stylesheet" href="/css/style.css">
  
  <link href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">
  
  <script src="//cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
  <script src="//cdn.bootcss.com/clipboard.js/1.5.9/clipboard.min.js"></script>
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false,
          fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
          scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.0.9/scrollreveal.min.js"
      }
  </script>

  
      <script>
          yiliaConfig.rootUrl = "/";
      </script>
  

  
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">任磊</a></h1>
        </hgroup>

        
        <p class="header-subtitle">每个人都在成神的路上，只不过有的人在走，而有的人在跑。</p>
        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:18231195685@sina.cn" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/2729748535" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/PleaseCallMeCoder" title="GitHub"></a>
                            
                                <a class="fa CSDN" target="_blank" href="http://blog.csdn.net/sdkfjksf?viewmode=list" title="CSDN"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AndroidStudio1-5/">AndroidStudio1.5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/App设计模式/">App设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bitmap/">Bitmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/BitmapRegionDecoder/">BitmapRegionDecoder</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CPU和GPU/">CPU和GPU</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Camera/">Camera</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JNI/">JNI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MAT/">MAT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MaterialDesign/">MaterialDesign</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NDK/">NDK</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Overdraw/">Overdraw</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RecyclerView/">RecyclerView</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TextView/">TextView</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Toolbar/">Toolbar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/View/">View</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ViewGroup/">ViewGroup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/View的工作原理/">View的工作原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hierarchyviewer/">hierarchyviewer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/include/">include</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jcenter/">jcenter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leakcanary/">leakcanary</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lint/">lint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/merge/">merge</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/paint/">paint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/surfaceview/">surfaceview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/viewstub/">viewstub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码片段/">代码片段</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存优化/">内存优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存泄漏/">内存泄漏</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/原生控件属性/">原生控件属性</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/可扩展/">可扩展</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/可维护/">可维护</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/大图加载/">大图加载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/官方demo/">官方demo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/官方文档/">官方文档</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/布局优化/">布局优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开源/">开源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化/">性能优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化关键点/">性能优化关键点</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化工具/">性能优化工具</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化概述/">性能优化概述</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/架构/">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/渲染优化/">渲染优化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/相机/">相机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/组合控件/">组合控件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/绘制/">绘制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自定义动画/">自定义动画</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自定义控件/">自定义控件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/重写/">重写</a></li></ul>
                    </div>
                </section>
                
                
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">任磊</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">任磊</a></h1>
            </hgroup>
            
            <p class="header-subtitle">每个人都在成神的路上，只不过有的人在走，而有的人在跑。</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:18231195685@sina.cn" title="Email"></a>
                            
                                <a class="fa 新浪微博" target="_blank" href="http://weibo.com/2729748535" title="新浪微博"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/PleaseCallMeCoder" title="GitHub"></a>
                            
                                <a class="fa CSDN" target="_blank" href="http://blog.csdn.net/sdkfjksf?viewmode=list" title="CSDN"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-Androd自定义控件（四）自定义类继承viewgroup" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/" class="article-date">
      <time datetime="2016-04-05T06:44:00.000Z" itemprop="datePublished">2016-04-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Androd自定义控件（四）自定义类继承viewgroup
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/自定义控件/">自定义控件</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ViewGroup/">ViewGroup</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/官方demo/">官方demo</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/自定义控件/">自定义控件</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>自定义类继承ViewGroup。</p>
<ul>
<li><a id="more"></a>
</li>
</ul>
<p>在前面已经跟大家分享了，自定义view概述，自定义view需要知道的方法，自定义类继承view，自定义组合控件。今天跟大家分享一下自定义类继承viewgroup，当初挖的坑也就快填完了（四种自定义view，今天是第三种），希望大家能有所收获。</p>
<p>###1.自定义viewgroup和组合控件的区别<br>从目的来看：<strong>大部分情况下组合控件是用创建一个囊括逻辑和布局的视图的方式，达到重复使用而不用在不同的场合中写重复的代码目的，而自定义viewgroup是更倾向于自定义属性来定制 ViewGroup 中子视图的位置。</strong></p>
<p>从实现方式来看：<strong>组合控件的一般需要加载一个已经写好的布局，声明方法来控制布局中写好的控件,不需要自己处理viewgroup的测量和布局的过程，比如自定义的App顶栏等。而自定义viewgroup一般是通过measure和layout来控制子view的位置，比如流式布局等。</strong></p>
<p>###2.ViewGroup概述</p>
<p>A ViewGroup is a special view that can contain other views (called children.) The view group is the base class for layouts and views containers. This class also defines the ViewGroup.LayoutParams class which serves as the base class for layouts parameters. </p>
<p><strong>一个ViewGroup是一个可以包含其他view的特殊View，ViewGroup是各个Layout和View容器组件的基类。这个类还定义了ViewGroup.LayoutParams类来作为布局参数的基类。</strong></p>
<p>LayoutParams are used by views to tell their parents how they want to be laid out.<br>The base LayoutParams class just describes how big the view wants to be for both width and height.</p>
<p><strong>LayoutParams 通常是子view用来告诉父容器他们的位置。基类LayoutParams 仅仅描述了子view的宽和高。</strong></p>
<p>###3.ViewGroup和LayoutParams之间的关系</p>
<p>不知道大家有没有注意到，当我们在LinearLayout中写子View的时候，可以用layout_gravity，layout_weight属性；而zaiRelativeLayout中的子View有layout_centerInParent属性，却没有layout_gravity，layout_weight，这是为什么呢？<strong>这是因为每个ViewGroup需要指定一个LayoutParams，用于确定支持子View哪些属性。</strong></p>
<p>###4.Android绘制视图的方式<br>Layout is a two pass process: a measure pass and a layout pass. The measuring pass is implemented in measure(int, int) and is a top-down traversal of the view tree. Each view pushes dimension specifications down the tree during the recursion. At the end of the measure pass, every view has stored its measurements. The second pass happens in layout(int, int, int, int) and is also top-down. During this pass each parent is responsible for positioning all of its children using the sizes computed in the measure pass. </p>
<p><strong>绘制布局由两个遍历过程组成： 测量过程和布局过程。 测量过程由 measure(int, int) 方法完成， 该方法从上到下遍历视图树。 在递归遍历过程中， 每个视图都会向下层传递尺寸和规格。 当measure 方法遍历结束， 每个视图都保存了各自的尺寸信息。 第二个过程由 layout(int, int, int,int) 方法完成， 该方法也是由上而下遍历视图树， 在遍历过程中， 每个父视图通过测量过程的结果定位所有子视图的位置信息。</strong></p>
<p>###5.自定义viewgroup的步骤</p>
<p>我们以官方文档中的demo为例。这是一个相对综合的例子，处理的几乎所有的布局情况。通过这个demo我们可以举一反三，把特殊情况简单。先看下效果图：</p>
<p><img src="http://img.blog.csdn.net/20160405181247461" alt="这里写图片描述"></p>
<p>实现效果：<strong>自定义类继承viewgroup实现linearlayout横向摆放的效果，并且自定义属性“layout_position”来控制子view在水平方向的位置。</strong></p>
<p>####自定义类继承ViewGroup，并初始化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">@RemoteViews.RemoteView</span><br><span class="line">public class CustomLayout extends ViewGroup &#123;</span><br><span class="line">    /** The amount of space used by children in the left gutter. */</span><br><span class="line">    private int mLeftWidth;</span><br><span class="line"></span><br><span class="line">    /** The amount of space used by children in the right gutter.</span><br><span class="line">     * 计算右侧的子view需要的空间。</span><br><span class="line">     */</span><br><span class="line">    private int mRightWidth;</span><br><span class="line"></span><br><span class="line">    /** These are used for computing child frames based on their gravity.</span><br><span class="line">     * 计算子view基于他们gravity的画面</span><br><span class="line">     */</span><br><span class="line">    private final Rect mTmpContainerRect = new Rect();</span><br><span class="line">    private final Rect mTmpChildRect = new Rect();</span><br><span class="line"></span><br><span class="line">    public CustomLayout(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public CustomLayout(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        this(context, attrs, 0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public CustomLayout(Context context, AttributeSet attrs, int defStyle) &#123;</span><br><span class="line">        super(context, attrs, defStyle);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>这里需要注意的一点是，如果我们自定义的viewgroup不需要滚动的话，尽量重写shouldDelayChildPressedState方法，并返回false。</strong></p>
<p>Return true if the pressed state should be delayed for children or descendants of this ViewGroup. Generally, this should be done for containers that can scroll, such as a List. This prevents the pressed state from appearing when the user is actually trying to scroll the content. The default implementation returns true for compatibility reasons. Subclasses that do not scroll should generally override this method and return false. </p>
<p>官方文档中的说明是，<strong>当返回false的时候，如果用户试图滚动内容，会阻止这个viewgroup出现按压状态。出于兼容的目的，这个方法默认是返回true的。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Any layout manager that doesn&apos;t scroll will want this.</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public boolean shouldDelayChildPressedState() &#123;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>####为子视图添加自定义属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;resources&gt;</span><br><span class="line"></span><br><span class="line">    &lt;declare-styleable name=&quot;CustomLayoutLP&quot;&gt;</span><br><span class="line">        &lt;attr name=&quot;android:layout_gravity&quot;/&gt;</span><br><span class="line">        &lt;attr name=&quot;layout_position&quot;&gt;</span><br><span class="line">            &lt;enum name=&quot;middle&quot; value=&quot;0&quot;/&gt;</span><br><span class="line">            &lt;enum name=&quot;left&quot; value=&quot;1&quot;/&gt;</span><br><span class="line">            &lt;enum name=&quot;right&quot; value=&quot;2&quot;/&gt;</span><br><span class="line">        &lt;/attr&gt;</span><br><span class="line">    &lt;/declare-styleable&gt;</span><br><span class="line"></span><br><span class="line">&lt;/resources&gt;</span><br></pre></td></tr></table></figure>
<p><strong>因为属性名的前缀是layout_，没有包含一个视图属性，因此该属性会被添加到LayoutParams的属性表中。</strong></p>
<p>同时，在onMeasure方法之前，要先创建一个自定义的LayoutParams，该类用于存储每个子视图的gravity和position。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">    * Custom per-child layout information.</span><br><span class="line">    * 创建自定义 LayoutParams类， 该类用于保存每个子视图的信息（gravity,position）</span><br><span class="line">    */</span><br><span class="line">   public static class LayoutParams extends MarginLayoutParams &#123;</span><br><span class="line">       /**</span><br><span class="line">        * The gravity to apply with the View to which these layout parameters</span><br><span class="line">        * are associated.</span><br><span class="line">        */</span><br><span class="line">       public int gravity = Gravity.TOP | Gravity.START;</span><br><span class="line"></span><br><span class="line">       public static int POSITION_MIDDLE = 0;</span><br><span class="line">       public static int POSITION_LEFT = 1;</span><br><span class="line">       public static int POSITION_RIGHT = 2;</span><br><span class="line"></span><br><span class="line">       public int position = POSITION_MIDDLE;</span><br><span class="line"></span><br><span class="line">       public LayoutParams(Context c, AttributeSet attrs) &#123;</span><br><span class="line">           super(c, attrs);</span><br><span class="line"></span><br><span class="line">           // Pull the layout param values from the layout XML during</span><br><span class="line">           // inflation.  This is not needed if you don&apos;t care about</span><br><span class="line">           // changing the layout behavior in XML.</span><br><span class="line">           TypedArray a = c.obtainStyledAttributes(attrs, R.styleable.CustomLayoutLP);</span><br><span class="line">           gravity = a.getInt(R.styleable.CustomLayoutLP_android_layout_gravity, gravity);</span><br><span class="line">           position = a.getInt(R.styleable.CustomLayoutLP_layout_position, position);</span><br><span class="line">           a.recycle();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       public LayoutParams(int width, int height) &#123;</span><br><span class="line">           super(width, height);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       public LayoutParams(ViewGroup.LayoutParams source) &#123;</span><br><span class="line">           super(source);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>要使用新定义的layoutparams，我们可能需要重写的方法为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// The rest of the implementation is for custom per-child layout parameters.</span><br><span class="line">    // If you do not need these (for example you are writing a layout manager</span><br><span class="line">    // that does fixed positioning of its children), you can drop all of this.</span><br><span class="line"> @Override</span><br><span class="line">    public LayoutParams generateLayoutParams(AttributeSet attrs) &#123;</span><br><span class="line">        return new CustomLayout.LayoutParams(getContext(), attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected LayoutParams generateDefaultLayoutParams() &#123;</span><br><span class="line">        return new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected ViewGroup.LayoutParams generateLayoutParams(ViewGroup.LayoutParams p) &#123;</span><br><span class="line">        return new LayoutParams(p);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected boolean checkLayoutParams(ViewGroup.LayoutParams p) &#123;</span><br><span class="line">        return p instanceof LayoutParams;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>但是从注释中我们了解到：<strong>如果我们用不到这些方法，比如我们的viewgroup中的子view是固定的，那么我们可以丢掉他们。</strong></p>
<p>####重写onMeasure（）方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * Ask all children to measure themselves and compute the measurement of this</span><br><span class="line">     * layout based on the children.</span><br><span class="line">     * 令每个子视图测量自身，计算该viewgroup基于子view的尺寸</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</span><br><span class="line">        int count = getChildCount();</span><br><span class="line"></span><br><span class="line">        // These keep track of the space we are using on the left and right for</span><br><span class="line">        // views positioned there; we need member variables so we can also use</span><br><span class="line">        // these for layout later.</span><br><span class="line">        mLeftWidth = 0;</span><br><span class="line">        mRightWidth = 0;</span><br><span class="line"></span><br><span class="line">        // Measurement will ultimately be computing these values.</span><br><span class="line">        //使用宽和高计算布局的最终大小</span><br><span class="line">        int maxHeight = 0;</span><br><span class="line">        int maxWidth = 0;</span><br><span class="line">        int childState = 0;</span><br><span class="line"></span><br><span class="line">        // Iterate through all children, measuring them and computing our dimensions</span><br><span class="line">        // from their size.</span><br><span class="line">        //遍历所有的孩子,从他们的大小测量和计算我们的大小</span><br><span class="line">        for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">            final View child = getChildAt(i);</span><br><span class="line">            if (child.getVisibility() != GONE) &#123;</span><br><span class="line">                // Measure the child.</span><br><span class="line">                //令每个子视图测量自身</span><br><span class="line">                measureChildWithMargins(child, widthMeasureSpec, 0, heightMeasureSpec, 0);</span><br><span class="line"></span><br><span class="line">                // Update our size information based on the layout params.  Children</span><br><span class="line">                // that asked to be positioned on the left or right go in those gutters.</span><br><span class="line">                final LayoutParams lp = (LayoutParams) child.getLayoutParams();</span><br><span class="line">                if (lp.position == LayoutParams.POSITION_LEFT) &#123;</span><br><span class="line">                    mLeftWidth += Math.max(maxWidth,</span><br><span class="line">                            child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin);</span><br><span class="line">                &#125; else if (lp.position == LayoutParams.POSITION_RIGHT) &#123;</span><br><span class="line">                    mRightWidth += Math.max(maxWidth,</span><br><span class="line">                            child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    maxWidth = Math.max(maxWidth,</span><br><span class="line">                            child.getMeasuredWidth() + lp.leftMargin + lp.rightMargin);</span><br><span class="line">                &#125;</span><br><span class="line">                maxHeight = Math.max(maxHeight,</span><br><span class="line">                        child.getMeasuredHeight() + lp.topMargin + lp.bottomMargin);</span><br><span class="line">                childState = combineMeasuredStates(childState, child.getMeasuredState());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Total width is the maximum width of all inner children plus the gutters.</span><br><span class="line">        maxWidth += mLeftWidth + mRightWidth;</span><br><span class="line"></span><br><span class="line">        // Check against our minimum height and width</span><br><span class="line">        maxHeight = Math.max(maxHeight, getSuggestedMinimumHeight());</span><br><span class="line">        maxWidth = Math.max(maxWidth, getSuggestedMinimumWidth());</span><br><span class="line"></span><br><span class="line">        // Report our final dimensions.</span><br><span class="line">        //使用计算的到的宽和高设置整个布局的测量尺寸</span><br><span class="line">        setMeasuredDimension(resolveSizeAndState(maxWidth, widthMeasureSpec, childState),</span><br><span class="line">                resolveSizeAndState(maxHeight, heightMeasureSpec,</span><br><span class="line">                        childState &lt;&lt; MEASURED_HEIGHT_STATE_SHIFT));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>####最后一步为onLayout（）方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * Position all children within this layout.</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    protected void onLayout(boolean changed, int left, int top, int right, int bottom) &#123;</span><br><span class="line">        final int count = getChildCount();</span><br><span class="line"></span><br><span class="line">        // These are the far left and right edges in which we are performing layout.</span><br><span class="line">        int leftPos = getPaddingLeft();</span><br><span class="line">        int rightPos = right - left - getPaddingRight();</span><br><span class="line"></span><br><span class="line">        // This is the middle region inside of the gutter.</span><br><span class="line">        final int middleLeft = leftPos + mLeftWidth;</span><br><span class="line">        final int middleRight = rightPos - mRightWidth;</span><br><span class="line"></span><br><span class="line">        // These are the top and bottom edges in which we are performing layout.</span><br><span class="line">        final int parentTop = getPaddingTop();</span><br><span class="line">        final int parentBottom = bottom - top - getPaddingBottom();</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">            final View child = getChildAt(i);</span><br><span class="line">            if (child.getVisibility() != GONE) &#123;</span><br><span class="line">                final LayoutParams lp = (LayoutParams) child.getLayoutParams();</span><br><span class="line"></span><br><span class="line">                final int width = child.getMeasuredWidth();</span><br><span class="line">                final int height = child.getMeasuredHeight();</span><br><span class="line"></span><br><span class="line">                // Compute the frame in which we are placing this child.</span><br><span class="line">                if (lp.position == LayoutParams.POSITION_LEFT) &#123;</span><br><span class="line">                    mTmpContainerRect.left = leftPos + lp.leftMargin;</span><br><span class="line">                    mTmpContainerRect.right = leftPos + width + lp.rightMargin;</span><br><span class="line">                    leftPos = mTmpContainerRect.right;</span><br><span class="line">                &#125; else if (lp.position == LayoutParams.POSITION_RIGHT) &#123;</span><br><span class="line">                    mTmpContainerRect.right = rightPos - lp.rightMargin;</span><br><span class="line">                    mTmpContainerRect.left = rightPos - width - lp.leftMargin;</span><br><span class="line">                    rightPos = mTmpContainerRect.left;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    mTmpContainerRect.left = middleLeft + lp.leftMargin;</span><br><span class="line">                    mTmpContainerRect.right = middleRight - lp.rightMargin;</span><br><span class="line">                &#125;</span><br><span class="line">                mTmpContainerRect.top = parentTop + lp.topMargin;</span><br><span class="line">                mTmpContainerRect.bottom = parentBottom - lp.bottomMargin;</span><br><span class="line"></span><br><span class="line">                // Use the child&apos;s gravity and size to determine its final</span><br><span class="line">                // frame within its container.</span><br><span class="line">                Gravity.apply(lp.gravity, width, height, mTmpContainerRect, mTmpChildRect);</span><br><span class="line"></span><br><span class="line">                // Place the child.</span><br><span class="line">                //放置子view</span><br><span class="line">                child.layout(mTmpChildRect.left, mTmpChildRect.top,</span><br><span class="line">                        mTmpChildRect.right, mTmpChildRect.bottom);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>上述逻辑并不复杂，循环调用子view的onlayout方法，根据onMeasure的到的参数对子view进行布局。</p>
<p>####在布局文件中使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;oracleen.customlayout.CustomLayout</span><br><span class="line">    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- put first view to left. --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;fill_vertical|center_horizontal&quot;</span><br><span class="line">        android:background=&quot;@color/test1&quot;</span><br><span class="line">        android:text=&quot;l1&quot;</span><br><span class="line">        app:layout_position=&quot;left&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- stack second view to left. --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;fill_vertical|center_horizontal&quot;</span><br><span class="line">        android:background=&quot;@color/test1&quot;</span><br><span class="line">        android:text=&quot;l2&quot;</span><br><span class="line">        app:layout_position=&quot;left&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- also put a view on the right. --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;fill_vertical|center_horizontal&quot;</span><br><span class="line">        android:background=&quot;@color/test1&quot;</span><br><span class="line">        android:text=&quot;r1&quot;</span><br><span class="line">        app:layout_position=&quot;right&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- by default views go in the middle; use fill vertical gravity --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;fill_vertical|center_horizontal&quot;</span><br><span class="line">        android:background=&quot;@color/test2&quot;</span><br><span class="line">        android:text=&quot;fill-vert&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- by default views go in the middle; use fill horizontal gravity --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;30dp&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;center_vertical|fill_horizontal&quot;</span><br><span class="line">        android:background=&quot;@color/test2&quot;</span><br><span class="line">        android:text=&quot;fill-horiz&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- by default views go in the middle; use top-left gravity --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;top|left&quot;</span><br><span class="line">        android:background=&quot;@color/test3&quot;</span><br><span class="line">        android:text=&quot;top-left&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- by default views go in the middle; use center gravity --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;center&quot;</span><br><span class="line">        android:background=&quot;@color/test3&quot;</span><br><span class="line">        android:text=&quot;center&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- by default views go in the middle; use bottom-right --&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_gravity=&quot;bottom|right&quot;</span><br><span class="line">        android:background=&quot;@color/test3&quot;</span><br><span class="line">        android:text=&quot;bottom-right&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/oracleen.customlayout.CustomLayout&gt;</span><br></pre></td></tr></table></figure>
<p>好，到这里基本就结束了。源码我也上传了，大部分方法都加了注释，<a href="http://download.csdn.net/detail/sdkfjksf/9482002" target="_blank" rel="external">点击这里下载。</a></p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/">Androd自定义控件（四）自定义类继承viewgroup</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">任磊</a></p>
        <p><span>发布时间:</span>2016-04-05, 14:44:00</p>
        <p><span>最后更新:</span>2016-05-06, 22:28:07</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/" title="Androd自定义控件（四）自定义类继承viewgroup">http://yoursite.com/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/　　作者: 任磊" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2016/04/09/这些Tips让你的App更容易维护/">
                    这些Tips让你的App更容易维护
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2016/03/29/Material Design实战/">
                    Material Design实战
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>

<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }

    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })

    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>





    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"Androd自定义控件（四）自定义类继承viewgroup　| PleaseCallMeCoder　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/" data-title="Androd自定义控件（四）自定义类继承viewgroup" data-url="http://yoursite.com/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"renleicoder"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2016/04/09/这些Tips让你的App更容易维护/" title="上一篇: 这些Tips让你的App更容易维护">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2016/03/29/Material Design实战/" title="下一篇: Material Design实战">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/05/04/TextView实战之你真的懂我么？/">TextView实战之你真的懂我么？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/29/Andorid自定义圆形渐变色进度条的从实现到开源/">Andorid自定义圆形渐变色进度条的从实现到开源</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/26/Android性能优化之Performance Tips/">Android性能优化之Performance Tips</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/19/Android性能优化之被忽视的Memory Leaks/">Android性能优化之被忽视的Memory Leaks</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/12/Androd自定义控件（五）打造自己的Camera/">Androd自定义控件（五）打造自己的Camera</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/09/这些Tips让你的App更容易维护/">这些Tips让你的App更容易维护</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/05/Androd自定义控件（四）自定义类继承viewgroup/">Androd自定义控件（四）自定义类继承viewgroup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/29/Material Design实战/">Material Design实战</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/28/Android性能优化之渲染优化的8个点/">Android性能优化之渲染优化的8个点</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/22/Android性能优化之工具篇/">Android性能优化之工具篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/20/AndrodUI优化之布局优化/">AndrodUI优化之布局优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/18/Android加载长图那些事/">Android加载长图那些事</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/Androd自定义控件（三）飞翔的小火箭/">Androd自定义控件（三）飞翔的小火箭</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/09/那些年大家都在谈论的Android性能优化/">那些年大家都在谈论的Android性能优化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/08/自定义view你需要知道的/">自定义view你需要知道的</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/06/Androd自定义控件（二）自定义类继承view/">Androd自定义控件（二）自定义类继承view</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/03/Android Studio1.5中NDK开发/">Android Studio1.5中NDK开发</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/29/N个非常有用的Android程序片段（持续更新）/">N个非常有用的Android程序片段（持续更新）</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/Androd自定义控件（一）概述/">Androd自定义控件（一）概述</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016 任磊
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >本站到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.1.22/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>